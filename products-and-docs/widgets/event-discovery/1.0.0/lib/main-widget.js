var widgetsLib=function(e){function t(s){if(i[s])return i[s].exports;var n=i[s]={i:s,l:!1,exports:{}};return e[s].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var i={};return t.m=e,t.c=i,t.i=function(e){return e},t.d=function(exports,e,i){t.o(exports,e)||Object.defineProperty(exports,e,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=4)}([function(e,exports,t){"use strict";function i(){return'\n    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"\n       preserveAspectRatio="xMidYMid" class="lds-reload show-more_spinner-svg" style="background: none;">\n      <g transform="rotate(201.01 50 50)">\n          <path class="show-more_spinner-circle-part" d="M50 15A35 35 0 1 0 74.787 25.213" fill="none"\n                stroke-width="12"></path>\n          <path class="show-more_spinner-arrow-part" d="M49 3L49 27L61 15L49 3"></path>\n          <animateTransform attributeName="transform" type="rotate" calcMode="linear" values="0 50 50;360 50 50"\n                            keyTimes="0;1" dur="1.7s" begin="0s" repeatCount="indefinite"></animateTransform>\n      </g>\n    </svg>\n  '}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default={getLoaderSVG:i}},function(e,exports,t){"use strict";function i(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}Object.defineProperty(exports,"__esModule",{value:!0});var s,n=exports.ATTRIBUTE_NAMES={ID:"w-id",WIDGET_TYPE:"w-type",DEFAULT_VALUE:"data-default-value",WIDGET_THEME:"w-theme",COLOR_SCHEME:"w-colorscheme",WIDGET_LAYOUT:"w-layout",WIDGET_HEIGHT:"w-height",WIDGET_BORDER:"w-border",WIDGET_EVENTS_PERIOD:"w-period",WIDGET_EVENTS_DATE_FROM:"w-startdatetime",WIDGET_EVENTS_DATE_TO:"w-enddatetime",BRANDING:"w-branding",PROPORTION:"w-proportion",ENABLE_INFINITY_SCROLL:"w-enableInfinityScroll",SHOW_LOAD_MORE_BUTTON:"w-showLoadMoreButton",MIN_HEIGHT:"w-minHeight",MAX_HEIGHT:"w-maxHeight",SHOW_FULL_EVENTS_NAMES:"w-showFullEventsNames",TITLE_COLOR:"w-titleColor",TITLE_HOVER_COLOR:"w-titleHoverColor",ARROW_COLOR:"w-arrowColor",ARROW_HOVER_COLOR:"w-arrowHoverColor",EVENT_DATE_COLOR:"w-dateColor",EVENT_DESCRIPTION_COLOR:"w-descriptionColor",EVENTS_COUNTER_COLOR:"w-counterColor",BORDER_COLOR:"w-bordercolor",BACKGROUND_COLOR:"w-backgroundcolor",BUY_BUTTON_BACKGROUND_COLOR:"w-buyButtonBackgroundColor",BUY_BUTTON_BACKGROUND_HOVER_COLOR:"w-buyButtonBackgroundHoverColor",BUY_BUTTON_TEXT_COLOR:"w-buyButtonTextColor",POWERED_BY_BACKGROUND_COLOR:"w-poweredByBackgroundColor",SHOW_MORE_BUTTON_BACKGROUND_COLOR:"w-showMoreButtonBackgroundColor",SHOW_MORE_BUTTON_BACKGROUND_HOVER_COLOR:"w-showMoreButtonBackgroundHoverColor",SHOW_MORE_BUTTON_TEXT_COLOR:"w-showMoreButtonTextColor",LOADING_EVENTS_SPINNER_COLOR:"w-loadingEventSpinnerColor",GRID_COLUMNS:"w-gridColumns"},o=exports.ATTRIBUTE_VALUES={WIDGET_THEME:{SIMPLE:"simple",OLD_SCHOOL:"oldschool",NEW_SCHOOL:"newschool",LIST_VIEW:"listview",LIST_VIEW_THUMBNAILS:"listviewthumbnails",GRID:"grid"},WIDGET_LAYOUT:{HORIZONTAL:"horizontal",VERTICAL:"vertical",FULLWIDTH:"fullwidth"},WIDGET_EVENTS_PERIOD:{CUSTOM:"custom"},COLOR_SCHEME:{LIGHT:"light",DARK:"dark",CUSTOM:"custom"},PROPORTION:{XXL:"xxl",M:"m",CUSTOM:"custom"},BRANDING:{TICKETMASTER:"Ticketmaster",TICKETWEB:"TicketWeb"}},r=exports.BASE_CUSTOM_THEME_ATTRIBUTES=[n.TITLE_COLOR,n.TITLE_HOVER_COLOR,n.EVENT_DATE_COLOR,n.EVENT_DESCRIPTION_COLOR,n.EVENTS_COUNTER_COLOR,n.BORDER_COLOR,n.BUY_BUTTON_BACKGROUND_COLOR,n.BUY_BUTTON_BACKGROUND_HOVER_COLOR,n.BUY_BUTTON_TEXT_COLOR,n.POWERED_BY_BACKGROUND_COLOR];exports.ALL_CUSTOM_THEME_ATTRIBUTES=[].concat(r,[n.BACKGROUND_COLOR,n.ARROW_COLOR,n.ARROW_HOVER_COLOR,n.SHOW_MORE_BUTTON_BACKGROUND_COLOR,n.SHOW_MORE_BUTTON_BACKGROUND_HOVER_COLOR,n.SHOW_MORE_BUTTON_TEXT_COLOR,n.LOADING_EVENTS_SPINNER_COLOR]),exports.AVAILABLE_CUSTOM_FIELDS_FOR_THEME=(s={},i(s,o.WIDGET_THEME.SIMPLE,[].concat(r,[n.ARROW_COLOR,n.ARROW_HOVER_COLOR])),i(s,o.WIDGET_THEME.OLD_SCHOOL,[].concat(r,[n.BACKGROUND_COLOR,n.ARROW_COLOR,n.ARROW_HOVER_COLOR])),i(s,o.WIDGET_THEME.NEW_SCHOOL,[].concat(r,[n.BACKGROUND_COLOR,n.ARROW_COLOR,n.ARROW_HOVER_COLOR])),i(s,o.WIDGET_THEME.LIST_VIEW,[].concat(r,[n.BACKGROUND_COLOR,n.SHOW_MORE_BUTTON_BACKGROUND_COLOR,n.SHOW_MORE_BUTTON_BACKGROUND_HOVER_COLOR,n.SHOW_MORE_BUTTON_TEXT_COLOR,n.LOADING_EVENTS_SPINNER_COLOR])),i(s,o.WIDGET_THEME.LIST_VIEW_THUMBNAILS,[].concat(r,[n.BACKGROUND_COLOR,n.SHOW_MORE_BUTTON_BACKGROUND_COLOR,n.SHOW_MORE_BUTTON_BACKGROUND_HOVER_COLOR,n.SHOW_MORE_BUTTON_TEXT_COLOR,n.LOADING_EVENTS_SPINNER_COLOR])),i(s,o.WIDGET_THEME.GRID,[].concat(r,[n.BACKGROUND_COLOR,n.SHOW_MORE_BUTTON_BACKGROUND_COLOR,n.SHOW_MORE_BUTTON_BACKGROUND_HOVER_COLOR,n.SHOW_MORE_BUTTON_TEXT_COLOR,n.LOADING_EVENTS_SPINNER_COLOR,n.GRID_COLUMNS])),s)},function(e,exports,t){"use strict";function i(){var e="id_universe_widget";if(!document.getElementById(e)){var t=document.createElement("script");t.setAttribute("src","https://www.universe.com/embed.js"),t.setAttribute("type","text/javascript"),t.setAttribute("charset","UTF-8"),t.setAttribute("id",e),(document.head||document.getElementsByTagName("head")[0]).appendChild(t)}}Object.defineProperty(exports,"__esModule",{value:!0});var s={embedUniversePlugin:i};exports.default=s},function(e,exports,t){"use strict";function i(e){ga(l+".send","event",e)}function s(e){!function(e,t,i,s,n,o,r){e.GoogleAnalyticsObject=n,e[n]=e[n]||function(){(e[n].q=e[n].q||[]).push(arguments)},e[n].l=1*new Date,o=t.createElement(i),r=t.getElementsByTagName(i)[0],o.async=1,o.src="https://www.google-analytics.com/analytics.js",r.parentNode.insertBefore(o,r)}(window,document,"script",0,"ga"),ga("create",r,"auto"),ga("create",a,"auto",l),ga("send","pageview"),o.sendEvent({eventCategory:e,eventAction:d.LOAD})}function n(e){return"ga('"+l+".send', 'event', "+JSON.stringify(e).replace(/"/g,"'")+");"}Object.defineProperty(exports,"__esModule",{value:!0});var o={initialize:s,sendEvent:i,getStringEventHandler:n};exports.default=o;var r=exports.TM_TRACKER_ID="UA-78315612-1",a=exports.DEVPORT_TRACKER_ID="UA-114077619-1",l=exports.DEVPORT_TRACKER_ALIAS="tmOpenPlatform",d=(exports.EVENT_CATEGORY={MAP_WIDGET:"MapWidget",CALENDAR_WIDGET:"CalendarWidget",COUNTDOWN_WIDGET:"CountdownWidget",EVENT_DISCOVERY_WIDGET:"EventDiscoveryWidget"},exports.EVENT_NAME={RENDERED:"rendered",LOAD:"load",BUY_BUTTON_CLICK:"buyButtonClick",EVENT_NAME_CLICK:"eventNameClick"});exports.CUSTOM_DIMENSIONS={API_KEY:"dimension1"}},function(e,exports,t){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var o,r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},a=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),l=t(3),d=i(l),h=t(2),c=i(h),u=t(0),v=i(u),g=t(1),m=(o={},n(o,g.ATTRIBUTE_NAMES.TITLE_COLOR,[{selector:".event-name",stylePropName:"color"}]),n(o,g.ATTRIBUTE_NAMES.TITLE_HOVER_COLOR,[{selector:".event-name:hover",stylePropName:"color"}]),n(o,g.ATTRIBUTE_NAMES.ARROW_COLOR,[{selector:".events_control-right",stylePropName:"border-color",getValue:function(e){return"transparent transparent transparent "+e}},{selector:".events_control-left",stylePropName:"border-color",getValue:function(e){return"transparent "+e+" transparent transparent "}}]),n(o,g.ATTRIBUTE_NAMES.ARROW_HOVER_COLOR,[{selector:".events_control-right:hover",stylePropName:"border-color",getValue:function(e){return"transparent transparent transparent "+e}},{selector:".events_control-left:hover",stylePropName:"border-color",getValue:function(e){return"transparent "+e+" transparent transparent "}}]),n(o,g.ATTRIBUTE_NAMES.EVENT_DATE_COLOR,[{selector:".event-date",stylePropName:"color"}]),n(o,g.ATTRIBUTE_NAMES.EVENT_DESCRIPTION_COLOR,[{selector:".event-address",stylePropName:"color"}]),n(o,g.ATTRIBUTE_NAMES.EVENTS_COUNTER_COLOR,[{selector:".events-counter",stylePropName:"color"}]),n(o,g.ATTRIBUTE_NAMES.BORDER_COLOR,[{selector:".events-root-container",stylePropName:"border-color"}]),n(o,g.ATTRIBUTE_NAMES.BACKGROUND_COLOR,[{selector:".events-root-container",stylePropName:"background"}]),n(o,g.ATTRIBUTE_NAMES.BUY_BUTTON_BACKGROUND_COLOR,[{selector:".event-buy-btn",stylePropName:"background-color"}]),n(o,g.ATTRIBUTE_NAMES.BUY_BUTTON_BACKGROUND_HOVER_COLOR,[{selector:".event-buy-btn:hover",stylePropName:"background-color"}]),n(o,g.ATTRIBUTE_NAMES.BUY_BUTTON_TEXT_COLOR,[{selector:".event-buy-btn",stylePropName:"color"}]),n(o,g.ATTRIBUTE_NAMES.POWERED_BY_BACKGROUND_COLOR,[{selector:".event-logo-box",stylePropName:"background-color"}]),n(o,g.ATTRIBUTE_NAMES.SHOW_MORE_BUTTON_BACKGROUND_COLOR,[{selector:".show-more_button",stylePropName:"background-color"}]),n(o,g.ATTRIBUTE_NAMES.SHOW_MORE_BUTTON_BACKGROUND_HOVER_COLOR,[{selector:".show-more_button:hover",stylePropName:"background-color"},{selector:".show-more_button:active",stylePropName:"background-color"}]),n(o,g.ATTRIBUTE_NAMES.SHOW_MORE_BUTTON_TEXT_COLOR,[{selector:".show-more_button",stylePropName:"color"}]),n(o,g.ATTRIBUTE_NAMES.LOADING_EVENTS_SPINNER_COLOR,[{selector:".show-more_spinner-circle-part",stylePropName:"stroke"},{selector:".show-more_spinner-arrow-part",stylePropName:"fill"}]),n(o,g.ATTRIBUTE_NAMES.GRID_COLUMNS,[{selector:".event-wrapper",stylePropName:"width",getValue:function(e){return 100/e+"% !important"}}]),o),E="show-more_button",p="show-more_spinner";d.default.initialize(l.EVENT_CATEGORY.EVENT_DISCOVERY_WIDGET);var f=function(){function e(t){var i=this;s(this,e),this.enableLoadMore=function(e){var t=document.createElement("div");t.innerHTML=v.default.getLoaderSVG({color:i.config.loadingeventspinnercolor}),t.setAttribute("class",p),t.style.display="none";var s=document.createElement("button");s.setAttribute("class",E),s.innerHTML="SHOW MORE",s.addEventListener("click",function(){var n=""+i.apiBaseUrl+e+"&apikey="+i.config.tmapikey;s.style.display="none",t.style.display="inline-block",i.makeRequest(i.eventsLoadingHandler,n)}),i.eventsRoot.appendChild(s),i.eventsRoot.appendChild(t)},this.loadMoreFeature=function(e){if(i.config.showloadmorebutton&&(i.config.theme===g.ATTRIBUTE_VALUES.WIDGET_THEME.LIST_VIEW||i.config.theme===g.ATTRIBUTE_VALUES.WIDGET_THEME.LIST_VIEW_THUMBNAILS||i.config.theme===g.ATTRIBUTE_VALUES.WIDGET_THEME.GRID)&&"fullwidth"===i.config.layout){var t=i.eventsRoot.getElementsByClassName(E)[0];t&&t.parentNode.removeChild(t);var s=i.eventsRoot.getElementsByClassName(p)[0];s&&s.parentNode.removeChild(s),e._links.next&&i.enableLoadMore(e._links.next.href)}},this.infiniteScrollFeature=function(e){if(i.config.enableinfinityscroll&&("listview"===i.config.theme||"listviewthumbnails"===i.config.theme)&&("vertical"===i.config.layout||"horizontal"===i.config.layout)){var t=i.eventsRoot.getElementsByClassName(p)[0];t&&t.parentNode.removeChild(t),e._links.next&&(i.nextEventsHref=e._links.next.href,i.scrollRootElement.addEventListener("scroll",i.infinityScrollHandler))}},this.infinityScrollHandler=function(){if(i.scrollRootElement.scrollHeight-(i.scrollRootElement.scrollTop+i.scrollRootElement.offsetHeight)<500){var e=document.createElement("div");e.setAttribute("class",p),e.innerHTML=v.default.getLoaderSVG({color:i.config.loadingeventspinnercolor}),i.eventsRoot.appendChild(e),i.makeRequest(i.eventsLoadingHandler,""+i.apiBaseUrl+i.nextEventsHref+"&apikey="+i.config.tmapikey),i.scrollRootElement.removeEventListener("scroll",i.infinityScrollHandler)}},t&&(this.widgetRoot=t,null===this.widgetRoot.querySelector(".events-root-container")&&(this.setUniqueWidgetId(),this.eventsRootContainer=document.createElement("div"),this.eventsRootContainer.classList.add("events-root-container"),this.widgetRoot.appendChild(this.eventsRootContainer),this.eventsRootDiv=document.createElement("div"),this.eventsRootDiv.setAttribute("class","ss"),this.eventsRootDiv.setAttribute("ss-container",""),this.eventsRootContainer.appendChild(this.eventsRootDiv),this.eventsRoot=document.createElement("ul"),this.eventsRoot.classList.add("events-root"),this.eventsRootDiv.appendChild(this.eventsRoot),this.themeModificators={oldschool:this.oldSchoolModificator.bind(this),newschool:this.newSchoolModificator.bind(this),listview:this.listViewModificator.bind(this),listviewthumbnails:this.listViewModificator.bind(this)},this.config=this.widgetRoot.attributes,this.listenerResize=[],null===this.config.theme||document.getElementById("widget-theme-"+this.config.theme)||this.addStylesheetForWidgetTheme(),this.eventsRootContainer.classList.remove("border"),this.config.border&&this.eventsRootContainer.classList.add("border"),this.widgetRoot.style.height=this.widgetHeight+"px",this.widgetRoot.style.width=this.config.width+"px",this.eventsRootContainer.style.height=this.widgetContentHeight+"px",this.eventsRootContainer.style.width=this.config.width+"px",this.eventsRootContainer.style.borderRadius=this.config.borderradius+"px",this.eventsRootContainer.style.borderWidth=this.borderSize+"px",this.AdditionalElements(),this.getCoordinates(function(){i.makeEventsRequest()}),this.themeModificators.hasOwnProperty(this.widgetConfig.theme)&&this.themeModificators[this.widgetConfig.theme](),c.default.embedUniversePlugin(),this.initBuyBtn(),this.initMessage(),this.isListView&&this.isListViewThumbnails&&this.isGridTheme||(this.initEventCounter(),this.initSliderControls()),this.isFullWidth&&this.initFullWidth(),(this.isListView||this.isListViewThumbnails||this.isGridTheme)&&(this.addScroll(),this.setListViewHeight()),this.defaultAnalyticsProperties=n({eventCategory:l.EVENT_CATEGORY.EVENT_DISCOVERY_WIDGET},l.CUSTOM_DIMENSIONS.API_KEY,this.eventReqAttrs.apikey),d.default.sendEvent(r({eventAction:l.EVENT_NAME.RENDERED},this.defaultAnalyticsProperties)),this.loadCustomStyle()))}return a(e,[{key:"isConfigAttrExistAndNotEmpty",value:function(e){return!(!this.config.hasOwnProperty(e)||"undefined"===this.config[e])&&""!==this.config[e]}},{key:"setUniqueWidgetId",value:function(){this.widgetRoot.getAttribute(g.ATTRIBUTE_NAMES.ID)||this.widgetRoot.setAttribute(g.ATTRIBUTE_NAMES.ID,"id_"+Math.random().toString(36).substring(7))}},{key:"config",set:function(e){this.widgetConfig=this.loadConfig(e)},get:function(){return this.widgetConfig}},{key:"events",set:function(e){this.eventsList=this.parseEvents(e)},get:function(){return this.eventsList}},{key:"isListView",get:function(){return"listview"===this.config.theme}},{key:"isListViewThumbnails",get:function(){return"listviewthumbnails"===this.config.theme}},{key:"isGridTheme",get:function(){return this.config.theme===g.ATTRIBUTE_VALUES.WIDGET_THEME.GRID}},{key:"isFullWidth",get:function(){return"fullwidth"===this.config.layout}},{key:"isPosterTheme",get:function(){return"simple"===this.config.layout}},{key:"isBarcodeWidget",get:function(){return"oldschool"===this.config.theme||"newschool"===this.config.theme}},{key:"isSimpleProportionM",get:function(){return"m"===this.config.proportion}},{key:"isCustomProportion",get:function(){return this.config.proportion===g.ATTRIBUTE_VALUES.PROPORTION.CUSTOM}},{key:"borderSize",get:function(){return this.config.border||0}},{key:"widgetHeight",get:function(){return this.config.height||600}},{key:"widgetContentHeight",get:function(){return this.widgetHeight-(this.isListView||this.isListViewThumbnails||this.isGridTheme||this.isSimpleProportionM||this.isFullWidth?0:39)||600}},{key:"defaultHeightForLayout",get:function(){var e;return(e={},n(e,g.ATTRIBUTE_VALUES.WIDGET_LAYOUT.VERTICAL,600),n(e,g.ATTRIBUTE_VALUES.WIDGET_LAYOUT.HORIZONTAL,339),n(e,g.ATTRIBUTE_VALUES.WIDGET_LAYOUT.FULLWIDTH,550),e)[this.config.layout]}},{key:"minWidgetHeight",get:function(){return this.config.minheight||this.defaultHeightForLayout}},{key:"maxWidgetHeight",get:function(){return this.config.maxheight||this.defaultHeightForLayout}},{key:"scrollRootElement",get:function(){return this.widgetRoot.getElementsByClassName("ss-content")[0]}},{key:"eventUrl",get:function(){return"https://www.ticketmaster.com/event/"}},{key:"apiBaseUrl",get:function(){return"https://app.ticketmaster.com"}},{key:"apiUrl",get:function(){return this.apiBaseUrl+"/discovery-widgets/v2/events"}},{key:"themeUrl",get:function(){return["developer.ticketmaster.com","developer-portal.staging.ticketmaster.com","localhost"].includes(window.location.host)?"/products-and-docs/widgets/event-discovery/1.0.0/theme/":"https://ticketmaster-api-staging.github.io/products-and-docs/widgets/event-discovery/1.0.0/theme/"}},{key:"portalUrl",get:function(){return"developer.ticketmaster.com"===window.location.host?"https://developer.ticketmaster.com/":"https://ticketmaster-api-staging.github.io/"}},{key:"logoUrl",get:function(){var e;return(e={},n(e,g.ATTRIBUTE_VALUES.BRANDING.TICKETMASTER,"https://www.ticketmaster.com/"),n(e,g.ATTRIBUTE_VALUES.BRANDING.TICKETWEB,"https://www.ticketweb.com/"),e)[this.config.branding]}},{key:"legalNoticeUrl",get:function(){return"https://developer.ticketmaster.com/support/terms-of-use/"}},{key:"questionUrl",get:function(){return"https://developer.ticketmaster.com/support/faq/"}},{key:"widgetVersion",get:function(){return"1.0.-4198"}},{key:"geocodeUrl",get:function(){return"https://maps.googleapis.com/maps/api/geocode/json"}},{key:"updateExceptions",get:function(){return["width","height","border","borderradius","colorscheme","layout","affiliateid","propotion","googleapikey"]}},{key:"sliderDelay",get:function(){return 5e3}},{key:"sliderRestartDelay",get:function(){return 5e3}},{key:"hideMessageDelay",get:function(){return 5e3}},{key:"controlHiddenClass",get:function(){return"events_control-hidden"}},{key:"tmWidgetWhiteList",get:function(){return["2200504BAD4C848F","00005044BDC83AE6","1B005068DB60687F","1B004F4DBEE45E47","3A004F4ED7829D5E","3A004F4ED1FC9B63","1B004F4FF83289C5","1B004F4FC0276888","0E004F4F3B7DC543","1D004F4F09C61861","1600505AC9A972A1","22004F4FD82795C6","01005057AFF54574","01005056FAD8793A","3A004F4FB2453240","22004F50D2149AC6","01005059AD49507A","01005062B4236D5D"]}},{key:"countriesWhiteList",get:function(){return["Australia","Austria","Belgium","Canada","Denmark","Finland","France","Germany","Ireland","Mexico","Netherlands","New Zealand","Norway","Spain","Sweden","Turkey","UAE","United Kingdom","United States"]}},{key:"eventReqAttrs",get:function(){var e=(this.eventsRootContainer.parentNode,{}),t=[{attr:"tmapikey",verboseName:"apikey"},{attr:"latlong",verboseName:"latlong"},{attr:"keyword",verboseName:"keyword"},{attr:"size",verboseName:"size"},{attr:"radius",verboseName:"radius"},{attr:"attractionid",verboseName:"attractionId"},{attr:"promoterid",verboseName:"promoterId"},{attr:"venueid",verboseName:"venueId"},{attr:"classificationname",verboseName:"classificationName"},{attr:"city",verboseName:"city"},{attr:"countrycode",verboseName:"countryCode"},{attr:"source",verboseName:"source"},{attr:"postalcode",verboseName:"postalCode"}];for(var i in t){var s=t[i];this.isConfigAttrExistAndNotEmpty(s.attr)&&(e[s.verboseName]=this.config[s.attr])}if(this.config.latlong&&(e.latlong=this.config.latlong.replace(/\s+/g,"")),this.isConfigAttrExistAndNotEmpty("period")){var n=this.getDateFromPeriod(this.config.period.toLowerCase()),o=n.firstDay,r=n.lastDay;o&&(e.startDateTime=o),r&&(e.endDateTime=r)}return null!=this.widgetRoot.getAttribute("w-latlong")&&(e.latlong=this.widgetRoot.getAttribute("w-latlong").replace(/\s+/g,"")),","==e.latlong&&delete e.latlong,null==e.latlong&&delete e.latlong,e}}]),a(e,[{key:"setRuleForStyleSheet",value:function(e,t,i){var s=this.widgetRoot.getAttribute(g.ATTRIBUTE_NAMES.ID);e.addRule("div[w-id="+s+"] "+t,i),e.insertRule("div[w-id="+s+"] "+t+" { "+i+" }")}},{key:"getStyleSheetNode",value:function(){var e=void 0;if(void 0===this.widgetRoot.getElementsByTagName("style")[0]){var t=document.createElement("style");this.widgetRoot.appendChild(t),e=t.sheet}else e=this.widgetRoot.getElementsByTagName("style")[0].sheet;return e}},{key:"removeStyleSheetNode",value:function(){var e=this.widgetRoot.getElementsByTagName("style")[0];e&&this.widgetRoot.removeChild(e)}},{key:"loadCustomStyle",value:function(){var e=this;g.AVAILABLE_CUSTOM_FIELDS_FOR_THEME[this.config.theme].forEach(function(t){var i=e.widgetRoot.getAttribute(t);i&&m[t].forEach(function(t){var s=t.getValue?t.getValue(i):i;e.setRuleForStyleSheet(e.getStyleSheetNode(),t.selector,t.stylePropName+": "+s)})})}},{key:"getParseGoogleGeocodeResponse",value:function(e){var t=this;return function(){if(this&&this.readyState===XMLHttpRequest.DONE){var i="",s=null,n="";if(200===this.status){var o=JSON.parse(this.responseText);if("OK"===o.status&&o.results.length)if(s=o.results.filter(function(e){return t.countriesWhiteList.filter(function(t){return t===e.address_components[e.address_components.length-1].long_name}).length>0}),s.length){s.sort(function(e,t){var i=e.address_components[e.address_components.length-1].long_name,s=t.address_components[t.address_components.length-1].long_name;return i>s?1:i<s?-1:0});var r=s[0].geometry;if(n=s[0].address_components[s[0].address_components.length-1].short_name,!t.config.country)for(var a in s){var l=s[a];if(l.address_components){var d=l.address_components[l.address_components.length-1];d&&"US"===d.short_name&&(n="US",r=l.geometry)}}r&&r.location&&(i=r.location.lat+","+r.location.lng)}else s=null}t.onLoadCoordinate&&t.onLoadCoordinate(s,n),t.config.latlong=i,e(t.config.latlong)}}}},{key:"getCoordinates",value:function(e){var t=this;if(this.isConfigAttrExistAndNotEmpty("postalcode")){var i={language:"en",components:"postal_code:"+t.config.postalcode};t.config.googleapikey&&(i.key=t.config.googleapikey),this.config.country&&(i.components+="|country:"+this.config.country),i.sort="date,asc",this.makeRequest(this.getParseGoogleGeocodeResponse(e),this.geocodeUrl,i)}else t.onLoadCoordinate&&t.onLoadCoordinate(null),t.config.latlong="",t.config.country="",e(t.config.latlong)}},{key:"initBuyBtn",value:function(){var e=this;this.buyBtn=document.createElement("a"),this.buyBtn.appendChild(document.createTextNode("BUY NOW")),this.buyBtn.classList.add("event-buy-btn"),this.buyBtn.classList.add("main-btn"),this.buyBtn.target="_blank",this.buyBtn.setAttribute("data-enable-widget",""),this.buyBtn.href="",this.buyBtn.addEventListener("click",function(t){e.stopAutoSlideX(),ga("send","event","DiscoveryClickBuyButton","click"),d.default.sendEvent(r({eventAction:l.EVENT_NAME.BUY_BUTTON_CLICK,eventLabel:e.buyBtn.href},e.defaultAnalyticsProperties))}),this.eventsRootContainer.appendChild(this.buyBtn)}},{key:"setBuyBtnUrl",value:function(){if(this.buyBtn){var e=this.eventsGroups[this.currentSlideX][this.currentSlideY];e&&e.url&&(this.buyBtn.href=e.url)}}},{key:"initMessage",value:function(){var e=this;this.messageDialog=document.createElement("div"),this.messageDialog.classList.add("event-message"),this.messageContent=document.createElement("div"),this.messageContent.classList.add("event-message__content");var t=document.createElement("div");t.classList.add("event-message__btn"),t.addEventListener("click",function(){e.hideMessage()}),this.messageDialog.appendChild(this.messageContent),this.messageDialog.appendChild(t),this.eventsRootContainer.appendChild(this.messageDialog)}},{key:"showMessage",value:function(e,t){e.length&&(this.hideMessageWithoutDelay=t,this.messageContent.innerHTML=e,this.messageDialog.classList.add("event-message-visible"),this.messageTimeout&&clearTimeout(this.messageTimeout))}},{key:"hideMessageWithDelay",value:function(e){var t=this;this.messageTimeout&&clearTimeout(this.messageTimeout),this.messageTimeout=setTimeout(function(){t.hideMessage()},e)}},{key:"hideMessage",value:function(){this.messageTimeout&&clearTimeout(this.messageTimeout),this.messageDialog.classList.remove("event-message-visible")}},{key:"AdditionalElements",value:function(){function e(e){e.preventDefault(),e.target.nextSibling.classList.toggle("show-tip")}var t=document.createTextNode("Legal Notice"),i=document.createElement("a");i.appendChild(t),i.classList.add("legal-notice"),i.target="_blank",i.href=this.legalNoticeUrl,this.widgetRoot.appendChild(i);var s=document.createElement("a");this.logoElement=s,s.classList.add("event-logo","right-logo"),s.target="_blank",s.href=this.logoUrl,s.innerHTML="Powered by ";var n=document.createElement("div");n.classList.add("event-logo-box"),n.appendChild(s),this.eventsRootContainer.appendChild(n);var o=document.createElement("span"),r=document.createElement("div"),a='\n      <div class="tooltip-inner"> \n        <a href="'+this.questionUrl+'" target = "_blank" >About widget</a>\n        <div class="place">version: <b>'+this.widgetVersion+"</b></div>\n      </div>";o.classList.add("event-question"),o.addEventListener("click",e),r.classList.add("tooltip-version"),r.classList.add("left"),r.innerHTML=a,this.eventsRootContainer.appendChild(o),this.eventsRootContainer.appendChild(r)}},{key:"oldSchoolModificator",value:function(){var e=document.createElement("div");e.classList.add("general-admission","modificator");var t=document.createElement("div"),i=document.createTextNode("GENERAL ADMISSION");t.appendChild(i),e.appendChild(t),this.eventsRootContainer.appendChild(e)}},{key:"newSchoolModificator",value:function(){var e=document.createElement("div");e.classList.add("ticket-logo","modificator");for(var t=0;t<4;t++){var i=document.createElement("img");i.setAttribute("src",this.portalUrl+"assets/widgets/1.0.0/img/ticketmaster-logo-white.svg"),i.setAttribute("height","11"),e.appendChild(i)}this.eventsRootContainer.appendChild(e)}},{key:"listViewModificator",value:function(){}},{key:"hideSliderControls",value:function(){this.prevEventX.classList.add(this.controlHiddenClass),this.nextEventX.classList.add(this.controlHiddenClass),this.prevEventY.classList.add(this.controlHiddenClass),this.nextEventY.classList.add(this.controlHiddenClass)}},{key:"toggleControlsVisibility",value:function(){this.slideCountX>1?(this.prevEventX.classList.remove(this.controlHiddenClass),this.nextEventX.classList.remove(this.controlHiddenClass),0===this.currentSlideX?this.prevEventX.classList.add(this.controlHiddenClass):this.currentSlideX===this.slideCountX-1&&this.nextEventX.classList.add(this.controlHiddenClass)):(this.prevEventX.classList.add(this.controlHiddenClass),this.nextEventX.classList.add(this.controlHiddenClass)),this.eventsGroups.length&&this.eventsGroups[this.currentSlideX].length>1?(this.prevEventY.classList.remove(this.controlHiddenClass),this.nextEventY.classList.remove(this.controlHiddenClass),0===this.currentSlideY?this.prevEventY.classList.add(this.controlHiddenClass):this.currentSlideY===this.eventsGroups[this.currentSlideX].length-1&&this.nextEventY.classList.add(this.controlHiddenClass)):(this.prevEventY.classList.add(this.controlHiddenClass),this.nextEventY.classList.add(this.controlHiddenClass))}},{key:"prevSlideX",value:function(){this.currentSlideX>0&&this.setSlideManually(this.currentSlideX-1,!0)}},{key:"nextSlideX",value:function(){this.slideCountX-1>this.currentSlideX&&this.setSlideManually(this.currentSlideX+1,!0)}},{key:"prevSlideY",value:function(){this.currentSlideY>0&&this.setSlideManually(this.currentSlideY-1,!1)}},{key:"nextSlideY",value:function(){this.eventsGroups[this.currentSlideX].length-1>this.currentSlideY&&this.setSlideManually(this.currentSlideY+1,!1)}},{key:"setSlideManually",value:function(e,t){var i=this;this.stopAutoSlideX(),this.sliderTimeout=setTimeout(function(){i.runAutoSlideX()},this.sliderRestartDelay),t?this.goToSlideX(e):this.goToSlideY(e)}},{key:"goToSlideX",value:function(e){this.currentSlideX!==e&&(this.currentSlideY=0,this.currentSlideX=e,this.eventsRoot.style.marginLeft="-"+100*this.currentSlideX+"%",this.toggleControlsVisibility(),this.setEventsCounter(),this.setBuyBtnUrl())}},{key:"goToSlideY",value:function(e){if(this.currentSlideY!==e){this.currentSlideY=e;var t=this.eventsRoot.getElementsByClassName("event-group-"+this.currentSlideX);t.length&&(t=t[0],t.style.marginTop="-"+this.currentSlideY*(this.widgetContentHeight-2*this.borderSize)+"px",this.toggleControlsVisibility(),this.setBuyBtnUrl())}}},{key:"runAutoSlideX",value:function(){var e=this;this.slideCountX>1&&(this.sliderInterval=setInterval(function(){var t=0;e.slideCountX-1>e.currentSlideX&&(t=e.currentSlideX+1),e.goToSlideX(t)},this.sliderDelay))}},{key:"stopAutoSlideX",value:function(){this.sliderTimeout&&clearTimeout(this.sliderTimeout),this.sliderInterval&&clearInterval(this.sliderInterval)}},{key:"initSliderControls",value:function(){function e(e){v=e.touches[0].clientX,g=e.touches[0].clientY}function t(e){if(v&&g){var t=e.touches[0].clientX,i=e.touches[0].clientY,s=v-t,n=g-i;Math.abs(s)>Math.abs(n)?s>0?this.nextSlideX():this.prevSlideX():n>0?this.nextSlideY():this.prevSlideY(),v=null,g=null}}var i=this;this.currentSlideX=0,this.currentSlideY=0,this.slideCountX=0;var s="events_control";this.prevEventX=document.createElement("div");var n=[s,s+"-horizontal",s+"-left",this.controlHiddenClass];for(var o in n)this.prevEventX.classList.add(n[o]);this.eventsRootContainer.appendChild(this.prevEventX),this.nextEventX=document.createElement("div");var r=[s,s+"-horizontal",s+"-right",this.controlHiddenClass];for(var a in r)this.nextEventX.classList.add(r[a]);this.eventsRootContainer.appendChild(this.nextEventX),this.prevEventY=document.createElement("div");var l=[s,s+"-vertical",s+"-top",this.controlHiddenClass];for(var d in l)this.prevEventY.classList.add(l[d]);this.eventsRootContainer.appendChild(this.prevEventY),this.nextEventY=document.createElement("div");var h=[s,s+"-vertical",s+"-bottom",this.controlHiddenClass];for(var c in h)this.nextEventY.classList.add(h[c]);this.eventsRootContainer.appendChild(this.nextEventY);var u=function(){var e=document.createElement("fakeelement"),t={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(var i in t)if(void 0!==e.style[i])return t[i]}();u&&this.eventsRoot.addEventListener(u,function(e){if(i.eventsRoot===e.target)for(var t=i.eventsRoot.getElementsByClassName("event-group"),s=0;t.length>s;s++)t[s].style.marginTop=0}),this.prevEventX.addEventListener("click",function(){i.prevSlideX()}),this.nextEventX.addEventListener("click",function(){i.nextSlideX()}),this.prevEventY.addEventListener("click",function(){i.prevSlideY()}),this.nextEventY.addEventListener("click",function(){i.nextSlideY()});var v=null,g=null;this.eventsRootContainer.addEventListener("touchstart",function(t){e.call(i,t)},!1),this.eventsRootContainer.addEventListener("touchmove",function(e){t.call(i,e)},!1)}},{key:"initSlider",value:function(){if(this.sliderInterval&&clearInterval(this.sliderInterval),this.sliderTimeout&&clearTimeout(this.sliderTimeout),this.slideCountX=this.eventsGroups.length,this.eventsRoot.style.marginLeft="0%",this.eventsRoot.style.width=this.isFullWidth?this.slideCountX*this.widgetRoot.offsetWidth+"px":100*this.slideCountX+"%",this.currentSlideX=0,this.currentSlideY=0,this.runAutoSlideX(),this.isFullWidth){var e=function(){n||(n=setTimeout(function(){n=null,t()},66))},t=function(){i.forEach(function(e){e.style.width=s.widgetRoot.offsetWidth+"px",e.style.height=s.widgetRoot.widgetContentHeight+"px"}),s.eventsRoot.style.width=s.isFullWidth?s.slideCountX*s.widgetRoot.offsetWidth+"px":100*s.slideCountX+"%"},i=this.widgetRoot.querySelectorAll("li"),s=this,n=void 0;window.addEventListener("resize",e,!1),this.listenerResize.push(e)}else this.listenerResize&&0!==this.listenerResize.length&&(window.removeEventListener("resize",this.listenerResize[0],!1),this.listenerResize.pop());this.toggleControlsVisibility(),this.setBuyBtnUrl()}},{key:"initFullWidth",value:function(){this.config.width="100%",this.config.height=550,this.widgetRoot.style.width="100%",this.widgetRoot.style.height="550px",this.widgetRoot.style.display="block",this.eventsRootContainer.style.width="100%",this.eventsRootContainer.style.height=this.widgetContentHeight+"px"}},{key:"setHeightFromContentHeight",value:function(){var e=this.scrollRootElement,t=this.scrollRootElement.scrollTop;if(e.style.height="unset",e.scrollHeight>=this.maxWidgetHeight-110)this.widgetRoot.style.height=this.maxWidgetHeight+"px",this.eventsRootContainer.style.height=this.maxWidgetHeight+"px",e.style.height=this.maxWidgetHeight-110+"px";else{var i=Math.max(e.scrollHeight,this.minWidgetHeight-110);this.widgetRoot.style.height=i+110+"px",this.eventsRootContainer.style.height=i+110+"px",e.style.height=i+"px"}this.scrollRootElement.scrollTop=t}},{key:"setListViewHeight",value:function(){this.widgetRoot.style.height=this.minWidgetHeight+"px",this.eventsRootContainer.style.height=this.minWidgetHeight+"px"}},{key:"formatDate",value:function(e){var t="";if(void 0===e)return t;if(!e.day)return t;var i=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],s=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],n=e.day.split("-"),o=parseInt(n[2]),r=parseInt(n[1]);if(t=s[new Date(+e.day.split("-")[0],+e.day.split("-")[1]-1,+e.day.split("-")[2]).getDay()]+", "+i[r-1]+" "+o+", "+n[0],!e.time)return t;var a=e.time.split(":"),l=parseInt(a[0]),d=a[1],h="AM";return l>11&&(h="PM"),0==l?l=12:l>12&&(l-=12),t+" "+function(e){return(e<0||e>9?"":"0")+e}(l)+":"+d+" "+h}},{key:"clearEvents",value:function(){this.eventsRoot.innerHTML=""}},{key:"clear",value:function(){for(var e=this.widgetRoot.getElementsByClassName("modificator");e.length;){var t=e[0];t.parentNode.removeChild(t)}if(!this.isListView&&!this.isListViewThumbnails&&!this.isGridTheme){var i=document.getElementsByClassName("events-root-container")[0],s=document.getElementsByClassName("events-root")[0],n=document.getElementsByClassName("ss")[0];n.parentNode.removeChild(n);var o=document.createElement("div");o.setAttribute("class","ss"),i.appendChild(o);var o=document.getElementsByClassName("ss")[0];o.appendChild(s);var i=document.getElementsByClassName("widget-container--discovery")[0];i.classList.remove("listview-after")}if(this.isListView||this.isListViewThumbnails||this.isFullWidth){var i=document.getElementsByClassName("widget-container--discovery")[0];i.classList.add("listview-after")}this.clearEvents()}},{key:"update",value:function(e){var t=this,i=this.eventsRoot.getElementsByClassName(p)[0];i&&i.parentNode.removeChild(i),this.scrollRootElement&&this.scrollRootElement.removeEventListener("scroll",this.infinityScrollHandler),this.removeStyleSheetNode();var s=this.config.constructor();for(var n in this.config)this.config.hasOwnProperty(n)&&(s[n]=this.config[n]);if(this.config=this.widgetRoot.attributes,(this.isListView||this.isListViewThumbnails||this.isGridTheme)&&this.stopAutoSlideX(),this.isFullWidth||(this.widgetRoot.style.width=this.config.width+"px",this.eventsRootContainer.style.width=this.config.width+"px"),(this.isListView||this.isListViewThumbnails||this.isGridTheme)&&(!this.isListView&&!this.isListViewThumbnails||this.isCustomProportion)||(this.widgetRoot.style.height=this.widgetHeight+"px",this.eventsRootContainer.style.height=this.widgetContentHeight+"px"),this.eventsRootContainer.style.borderRadius=this.config.borderradius+"px",this.eventsRootContainer.style.borderWidth=this.borderSize+"px",this.eventsRootContainer.classList.remove("border"),this.config.hasOwnProperty("border")&&this.eventsRootContainer.classList.add("border"),!this.needToUpdate(this.config,s,this.updateExceptions)||this.needToUpdate(this.config,s,this.updateExceptions))this.clear(),this.themeModificators.hasOwnProperty(this.widgetConfig.theme)&&this.themeModificators[this.widgetConfig.theme](),this.getCoordinates(function(){t.makeEventsRequest()}),this.isFullWidth&&this.initFullWidth(),(this.isListView||this.isListViewThumbnails||this.isGridTheme)&&(this.addScroll(),this.setListViewHeight()),this.logoElement.href=this.logoUrl;else{var o=this.eventsRoot.getElementsByClassName("event-wrapper");for(var r in o)o.hasOwnProperty(r)&&void 0!==o[r].style&&(o[r].style.width=this.config.width-2*this.borderSize+"px",o[r].style.height=this.widgetContentHeight-2*this.borderSize+"px");(this.isListView||this.isListViewThumbnails)&&this.isGridTheme||this.goToSlideY(0)}e||this.loadCustomStyle()}},{key:"needToUpdate",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return Object.keys(e).map(function(s){return i.indexOf(s)>-1||e[s]===t[s]}).indexOf(!1)>-1}},{key:"loadConfig",value:function(e){var t={};return Object.keys(e).map(function(i){void 0!==e[i].name&&-1!==e[i].name.indexOf("w-")&&(t[e[i].name.replace(/w-/g,"").replace(/-/g,"")]=e[i].value)}),t}},{key:"addStylesheetForWidgetTheme",value:function(){var e=document.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("type","text/css"),e.setAttribute("href",""+this.themeUrl+this.config.theme+".css"),e.setAttribute("id","widget-theme-"+this.config.theme),document.getElementsByTagName("head")[0].appendChild(e)}},{key:"groupEventsByName",value:function(){var e={};this.events.map(function(t){void 0===e[t.name]&&(e[t.name]=[]),e[t.name].push(t)}),this.eventsGroups=[];for(var t in e)this.eventsGroups.push(e[t])}},{key:"initEventCounter",value:function(){this.eventsCounter=document.createElement("div"),this.eventsCounter.classList.add("events-counter"),this.widgetRoot.appendChild(this.eventsCounter)}},{key:"setEventsCounter",value:function(){if(this.eventsCounter){var e="";this.eventsGroups.length&&(e=this.eventsGroups.length>1?this.currentSlideX+1+" of "+this.eventsGroups.length+" events":"1 event"),this.eventsCounter.innerHTML=e}}},{key:"resetReduceParamsOrder",value:function(){this.reduceParamsOrder=0}},{key:"reduceParamsAndReloadEvents",value:function(){var e={},t=[["classificationName"],["city"],["countryCode"],["source"],["startDateTime","endDateTime","country"],["radius"],["postalCode","latlong"],["attractionId"],["promoterId"],["venueId"],["keyword"],["size"]];for(var i in this.eventReqAttrs)e[i]=this.eventReqAttrs[i];if(this.reduceParamsOrder||(this.reduceParamsOrder=0),t.length>this.reduceParamsOrder){for(var s in t)if(this.reduceParamsOrder>=s)for(var n in t[s])delete e[t[s][n]];0===this.reduceParamsOrder&&this.showMessage("No results were found.<br/>Here other options for you."),this.reduceParamsOrder++,e.locale="*",e.sort="date,asc",this.makeRequest(this.eventsLoadingHandler,this.apiUrl,e)}else this.showMessage("No results were found.",!0),this.reduceParamsOrder=0,this.hideSliderControls(),document.querySelector(".event-buy-btn.main-btn").setAttribute("href",""),this.stopAutoSlideX()}},{key:"eventsLoadingHandler",value:function(){var e=this.widget;if(this&&this.readyState==XMLHttpRequest.DONE)if(200==this.status){var t=JSON.parse(this.responseText);if(e.events=t,e.events.length){var i=e.widgetRoot.getAttribute("w-sorting");"groupByName"!=i&&i?(e.eventsGroups=e.events,e.eventsGroups.map(function(t){e.publishEvent(t)})):(e.groupEventsByName.call(e),e.config.theme===g.ATTRIBUTE_VALUES.WIDGET_THEME.GRID?e.eventsGroups.reduce(function(e,t){return e.concat(t)},[]).forEach(function(t){e.publishEvent(t)}):e.eventsGroups.map(function(t,i){1===t.length?e.publishEvent(t[0]):e.publishEventsGroup.call(e,t,i)})),e.loadMoreFeature(t),e.infiniteScrollFeature(t),e.setEventsCounter(),e.resetReduceParamsOrder(),e.isListView||e.isListViewThumbnails||e.isGridTheme||e.initSlider(),e.hideMessageWithoutDelay?e.hideMessage():e.hideMessageWithDelay(e.hideMessageDelay),(e.isCustomProportion&&(e.isListView||e.isListViewThumbnails)||e.isGridTheme)&&e.setHeightFromContentHeight()}else e.reduceParamsAndReloadEvents.call(e)}else 429===this.status?e.makeRequest(e.eventsLoadingHandler,this.responseURL):e.reduceParamsAndReloadEvents.call(e)}},{key:"makeEventsRequest",value:function(){var e=Object.assign(this.eventReqAttrs,{locale:"*",sort:"date,asc"});this.makeRequest(this.eventsLoadingHandler,this.apiUrl,e)}},{key:"publishEventsGroup",value:function(e,t){var i=this,s=document.createElement("li");s.classList.add("event-wrapper"),s.classList.add("event-group-wrapper"),s.style.width=this.isFullWidth?this.widgetRoot.offsetWidth-2*this.borderSize+"px":this.config.width-2*this.borderSize+"px",s.style.height=(this.isFullWidth,this.widgetContentHeight-2*this.borderSize+"px");var n=document.createElement("ul");n.classList.add("event-group"),n.classList.add("event-group-"+t),e.map(function(e){i.publishEvent(e,n)}),s.appendChild(n),this.eventsRoot.appendChild(s)}},{key:"publishEvent",value:function(e,t){t=t||this.eventsRoot;var i=this.createDOMItem(e);t.appendChild(i)}},{key:"getEventByID",value:function(e){for(var t in this.events)if(this.events.hasOwnProperty(t)&&this.events[t].id===e)return this.events[t]}},{key:"getImageForEvent",value:function(e,t,i){var s=this.config.width,n=this.widgetContentHeight;"100%"===s&&(s=this.widgetRoot.offsetWidth),e.sort(function(e,t){return e.width<t.width?-1:e.width>t.width?1:0});var o="";return e.forEach(function(e){e.width>=s&&e.height>=n&&!o&&(o=e.url)}),t&&(o=e[0].url,i&&(o=e[2].url)),o}},{key:"parseEvents",value:function(e){if(!e._embedded)return"undefined"!=typeof $widgetModalNoCode&&$widgetModalNoCode.modal(),[];e=e._embedded.events;var t=[];for(var i in e)if(e.hasOwnProperty(i)){var s={};s.id=e[i].id,s.url=e[i].url,s.name=e[i].name;var n=document.createElement("a");n.href=s.url;if(null!==n.href.match("/ticketmaster.evyy.net/")){var o=n.pathname.split("/");o[3]="330564",s.url=n.origin+o.join("/")+n.search+n.hash}if(s.date={day:e[i].dates.start.localDate,time:e[i].dates.start.localTime},e[i].hasOwnProperty("_embedded")&&e[i]._embedded.hasOwnProperty("venues")){var r=e[i]._embedded.venues[0];r&&(r.address&&(s.address=r.address),r.name&&(s.address||(s.address={}),s.address.name=r.name))}s.img=this.getImageForEvent(e[i].images,this.isListViewThumbnails||this.isGridTheme,this.isFullWidth),t.push(s)}return t}},{key:"makeRequest",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.apiUrl,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"GET";i=Object.keys(i).map(function(e){return e+"="+i[e]}).join("&"),i&&(t=[t,i].join("?")),this.xmlHTTP=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),"POST"==s&&this.xmlHTTP.setRequestHeader("Content-type","application/x-www-form-urlencoded"),this.xmlHTTP.widget=this,this.xmlHTTP.onreadystatechange=e,this.xmlHTTP.open(s,t,!0),this.xmlHTTP.send()}},{key:"initPretendedLink",value:function(e,t,i){return e&&t&&(e.setAttribute("data-url",t),e.classList.add("event-pretended-link"),e.addEventListener("click",function(){var e=this.getAttribute("data-url");if(e){window.open(e,i?"_blank":"_self").focus()}}),e.addEventListener("touchend",function(){var e=this.getAttribute("data-url");if(e){var t=window.open(e,i?"_blank":"_self");t&&t.focus()}})),e}},{key:"createBackgroundImage",value:function(e,t){if(!this.isListView&&!this.isListViewThumbnails&&!this.isGridTheme){var i=document.createElement("span");i.classList.add("bg-cover"),i.style.backgroundImage="url('"+t+"')",e.appendChild(i)}if(this.isListViewThumbnails||this.isGridTheme){var s=document.createElement("div"),i=document.createElement("span");return s.classList.add("wrapper-thumbnails"),i.classList.add("bg-cover-thumbnails"),i.style.backgroundImage="url('"+t+"')",t||(i.classList.add("bg-cover-default"),i.removeAttribute("style")),s.appendChild(i),e.appendChild(s),s}}},{key:"addBarcode",value:function(e,t){var i=this;if(this.isBarcodeWidget){var s=document.createElement("a");s.classList.add("barcode"),s.target="_blank",s.href=t,s.addEventListener("click",function(e){ga("send","event","DiscoveryClickEventName","click"),d.default.sendEvent(r({eventAction:l.EVENT_NAME.EVENT_NAME_CLICK,eventLabel:s.href},i.defaultAnalyticsProperties))}),e.appendChild(s);var n=document.createElement("span");n.classList.add("barcode-bottom"),e.appendChild(n)}}},{key:"addBuyButton",value:function(e,t){var i=this,s=document.createElement("a");s.appendChild(document.createTextNode("BUY NOW")),s.classList.add("event-buy-btn"),s.target="_blank",s.href=t,s.addEventListener("click",function(e){ga("send","event","DiscoveryClickBuyButton","click"),d.default.sendEvent(r({eventAction:l.EVENT_NAME.BUY_BUTTON_CLICK,eventLabel:s.href},i.defaultAnalyticsProperties))}),e.appendChild(s)}},{key:"addSimpleScrollBar",value:function(){!function(e,t){function i(e){e.hasOwnProperty("data-simple-scrollbar")||Object.defineProperty(e,"data-simple-scrollbar",new SimpleScrollbar(e))}function s(e,i){function s(e){var t=e.pageY-o;o=e.pageY,r(function(){i.el.scrollTop+=t/i.scrollRatio})}function n(){e.classList.remove("ss-grabbed"),t.body.classList.remove("ss-grabbed"),t.removeEventListener("mousemove",s),t.removeEventListener("mouseup",n)}var o;e.addEventListener("mousedown",function(i){return o=i.pageY,e.classList.add("ss-grabbed"),t.body.classList.add("ss-grabbed"),t.addEventListener("mousemove",s),t.addEventListener("mouseup",n),!1})}function n(e){for(this.target=e,this.bar='<div class="ss-scroll">',this.wrapper=t.createElement("div"),this.wrapper.setAttribute("class","ss-wrapper"),this.el=t.createElement("div"),this.el.setAttribute("class","ss-content"),this.wrapper.appendChild(this.el);this.target.firstChild;)this.el.appendChild(this.target.firstChild);this.target.appendChild(this.wrapper),this.target.insertAdjacentHTML("beforeend",this.bar),this.bar=this.target.lastChild,s(this.bar,this),this.moveBar(),this.el.addEventListener("scroll",this.moveBar.bind(this)),this.el.addEventListener("mouseenter",this.moveBar.bind(this)),this.target.classList.add("ss-container")}function o(){for(var e=t.querySelectorAll("*[ss-container]"),s=0;s<e.length;s++)i(e[s])}var r=e.requestAnimationFrame||e.setImmediate||function(e){return setTimeout(e,0)};n.prototype={moveBar:function(){var e=this.el.scrollHeight,t=this.el.clientHeight,i=this;this.scrollRatio=t/e,r(function(){i.bar.style.cssText="height:"+t/e*100+"%; top:"+i.el.scrollTop/e*100+"%;right:-"+(i.target.clientWidth-i.bar.clientWidth)+"px;"})}},t.addEventListener("DOMContentLoaded",o),n.initEl=i,n.initAll=o,e.SimpleScrollbar=n}(window,document)}},{key:"addScroll",value:function(){this.addSimpleScrollBar();var e=document.querySelector(".ss");SimpleScrollbar.initEl(e)}},{key:"createDOMItem",value:function(e){var t=this,i=document.createElement("div");i.classList.add("event-content-wraper");var s=document.createElement("li");s.classList.add("event-wrapper"),s.style.height=(this.isFullWidth,this.widgetContentHeight-2*this.borderSize+"px"),s.style.width=this.isFullWidth?this.widgetRoot.offsetWidth-2*this.borderSize+"px":this.config.width-2*this.borderSize+"px";var n=this.createBackgroundImage(s,e.img),o=document.querySelector('[w-type="event-discovery"]').getAttribute("w-titlelink"),a=document.createTextNode(e.name);if(o&&"off"==o){var h=document.createElement("span");h.classList.add("event-name"),h.appendChild(a),this.initPretendedLink(h,e.url,!0),h.addEventListener("click",function(i){ga("send","event","DiscoveryClickeventName","click",e.url),d.default.sendEvent(r({eventAction:l.EVENT_NAME.EVENT_NAME_CLICK,eventLabel:e.url},t.defaultAnalyticsProperties))}),i.appendChild(h)}else{var c=document.createElement("a");c.classList.add("event-name"),c.classList.add("event-pretended-link"),c.href=e.url,c.appendChild(a),c.setAttribute("onclick",""),c.addEventListener("click",function(i){ga("send","event","DiscoveryClickeventName","click",e.url),d.default.sendEvent(r({eventAction:l.EVENT_NAME.EVENT_NAME_CLICK,eventLabel:e.url},t.defaultAnalyticsProperties))}),i.appendChild(c)}this.addBarcode(s,e.url),(this.isListView||this.isListViewThumbnails)&&this.addBuyButton(this.isListViewThumbnails?n:i,e.url);var u=document.createTextNode(this.formatDate(e.date)),v=document.createElement("span");v.classList.add("event-date"),v.appendChild(u);var g=document.createElement("span");if(g.classList.add("event-date-wraper"),g.appendChild(v),i.appendChild(g),e.hasOwnProperty("address")){var m=document.createElement("span");if(m.classList.add("address-wrapper"),e.address.hasOwnProperty("name")){var E=document.createTextNode(e.address.name),p=document.createElement("span");p.classList.add("event-address"),p.classList.add("event-address-name"),p.appendChild(E),m.appendChild(p)}if(e.address.hasOwnProperty("line1")){var f=document.createTextNode(e.address.line1),T=document.createElement("span");T.classList.add("event-address"),T.appendChild(f),m.appendChild(T)}if(e.address.hasOwnProperty("line2")){var O=document.createTextNode(e.address.line2),R=document.createElement("span");R.classList.add("event-address"),R.appendChild(O),m.appendChild(R)}i.appendChild(m)}if(e.hasOwnProperty("categories")){var y=document.createElement("span");y.classList.add("category-wrapper"),e.categories.forEach(function(e){var t=document.createTextNode(e),i=document.createElement("span");i.classList.add("event-category"),i.appendChild(t),y.appendChild(i)}),i.appendChild(y)}return this.isGridTheme&&this.addBuyButton(i,e.url),s.appendChild(i),s}},{key:"decConfig",value:function(e){return JSON.parse(window.atob(e))}},{key:"encConfig",value:function(e){return window.btoa(e)}},{key:"toShortISOString",value:function(e){return e.getFullYear()+"-"+(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-"+(e.getDate()<10?"0"+e.getDate():e.getDate())+"T"+(e.getHours()<10?"0"+e.getHours():e.getHours())+":"+(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes())+":"+(e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds())+"Z"}},{key:"getDateFromPeriod",value:function(e){var t=(new Date).toISOString().slice(0,11)+"00:00:00Z",i=void 0;return"year"===e?i=new Date((new Date).valueOf()+31536e6).toISOString().slice(0,11)+"00:00:00Z":e===g.ATTRIBUTE_VALUES.WIDGET_EVENTS_PERIOD.CUSTOM?(t=this.config.startdatetime&&this.config.startdatetime+"T00:00:00Z",i=this.config.enddatetime&&this.config.enddatetime+"T23:59:59Z"):i="month"===e?new Date((new Date).valueOf()+26784e5).toISOString().slice(0,11)+"00:00:00Z":"week"===e?new Date((new Date).valueOf()+6048e5).toISOString().slice(0,11)+"00:00:00Z":new Date((new Date).valueOf()+864e5).toISOString().slice(0,11)+"00:00:00Z",{firstDay:t,lastDay:i}}}]),e}(),T=[];!function(){for(var e=document.querySelectorAll("div[w-type='event-discovery']"),t=0;t<e.length;++t)T.push(new f(e[t]))}(),e.exports={widgetsEventDiscovery:T,TicketmasterEventDiscoveryWidget:f}}]);